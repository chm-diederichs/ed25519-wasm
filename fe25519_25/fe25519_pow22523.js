
module.exports = loadWebAssembly

loadWebAssembly.supported = typeof WebAssembly !== 'undefined'

function loadWebAssembly (opts) {
  if (!loadWebAssembly.supported) return null

  var imp = opts && opts.imports
  var wasm = toUint8Array('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IwAjASMCIwMjBCMFIwYjByMIIwkjACMBIwIjAyMEIwUjBiMHIwgjCRAJIA4gECASIBQgFiAYIBogHCAeICAjACMBIwIjAyMEIwUjBiMHIwgjCRAJIwAhDSMBIQ8jAiERIwMhEyMEIRUjBSEXIwYhGSMHIRsjCCEdIwkhHwJAA0BBBSAMRg0BIAxBAWohDCMAIwEjAiMDIwQjBSMGIwcjCCMJIwAjASMCIwMjBCMFIwYjByMIIwkQCQwACwtBACEMIwAhDiMBIRAjAiESIwMhFCMEIRYjBSEYIwYhGiMHIRwjCCEeIwkhICANIA8gESATIBUgFyAZIBsgHSAfIwAjASMCIwMjBCMFIwYjByMIIwkQCSMAIQ0jASEPIwIhESMDIRMjBCEVIwUhFyMGIRkjByEbIwghHSMJIR8CQANAQQogDEYNASAMQQFqIQwjACMBIwIjAyMEIwUjBiMHIwgjCSMAIwEjAiMDIwQjBSMGIwcjCCMJEAkMAAsLQQAhDCANIA8gESATIBUgFyAZIBsgHSAfIwAjASMCIwMjBCMFIwYjByMIIwkQCSMAIQ4jASEQIwIhEiMDIRQjBCEWIwUhGCMGIRojByEcIwghHiMJISACQANAQRQgDEYNASAMQQFqIQwjACMBIwIjAyMEIwUjBiMHIwgjCSMAIwEjAiMDIwQjBSMGIwcjCCMJEAkMAAsLQQAhDCAOIBAgEiAUIBYgGCAaIBwgHiAgIwAjASMCIwMjBCMFIwYjByMIIwkQCQJAA0BBCiAMRg0BIAxBAWohDCMAIwEjAiMDIwQjBSMGIwcjCCMJIwAjASMCIwMjBCMFIwYjByMIIwkQCQwACwtBACEMIA0gDyARIBMgFSAXIBkgGyAdIB8jACMBIwIjAyMEIwUjBiMHIwgjCRAJIwAhDSMBIQ8jAiERIwMhEyMEIRUjBSEXIwYhGSMHIRsjCCEdIwkhHwJAA0BBMiAMRg0BIAxBAWohDCMAIwEjAiMDIwQjBSMGIwcjCCMJIwAjASMCIwMjBCMFIwYjByMIIwkQCQwACwtBACEMIA0gDyARIBMgFSAXIBkgGyAdIB8jACMBIwIjAyMEIwUjBiMHIwgjCRAJIwAhDiMBIRAjAiESIwMhFCMEIRYjBSEYIwYhGiMHIRwjCCEeIwkhIAJAA0BB5AAgDEYNASAMQQFqIQwjACMBIwIjAyMEIwUjBiMHIwgjCSMAIwEjAiMDIwQjBSMGIwcjCCMJEAkMAAsLQQAhDCAOIBAgEiAUIBYgGCAaIBwgHiAgIwAjASMCIwMjBCMFIwYjByMIIwkQCQJAA0BBMiAMRg0BIAxBAWohDCMAIwEjAiMDIwQjBSMGIwcjCCMJIwAjASMCIwMjBCMFIwYjByMIIwkQCQwACwtBACEMIA0gDyARIBMgFSAXIBkgGyAdIB8jACMBIwIjAyMEIwUjBiMHIwgjCRAJIwAjASMCIwMjBCMFIwYjByMIIwkjACMBIwIjAyMEIwUjBiMHIwgjCRAJIwAjASMCIwMjBCMFIwYjByMIIwkjACMBIwIjAyMEIwUjBiMHIwgjCRAJIAIgAyAEIAUgBiAHIAggCSAKIAsjACMBIwIjAyMEIwUjBiMHIwgjCRAJIAAjAD4CACAAIwE+AgQgACMCPgIIIAAjAz4CDCAAIwQ+AhAgACMFPgIUIAAjBj4CGCAAIwc+AhwgACMIPgIgIAAjCT4CJAs=')
  var ready = null

  var mod = {
    buffer: wasm,
    memory: null,
    exports: null,
    realloc: realloc,
    onload: onload
  }

  onload(function () {})

  return mod

  function realloc (size) {
    mod.exports.memory.grow(Math.max(0, Math.ceil(Math.abs(size - mod.memory.length) / 65536)))
    mod.memory = new Uint8Array(mod.exports.memory.buffer)
  }

  function onload (cb) {
    if (mod.exports) return cb()

    if (ready) {
      ready.then(cb.bind(null, null)).catch(cb)
      return
    }

    try {
      if (opts && opts.async) throw new Error('async')
      setup({instance: new WebAssembly.Instance(new WebAssembly.Module(wasm), imp)})
    } catch (err) {
      ready = WebAssembly.instantiate(wasm, imp).then(setup)
    }

    onload(cb)
  }

  function setup (w) {
    mod.exports = w.instance.exports
    mod.memory = mod.exports.memory && mod.exports.memory.buffer && new Uint8Array(mod.exports.memory.buffer)
  }
}

function toUint8Array (s) {
  if (typeof atob === 'function') return new Uint8Array(atob(s).split('').map(charCodeAt))
  return (require('buf' + 'fer').Buffer).from(s, 'base64')
}

function charCodeAt (c) {
  return c.charCodeAt(0)
}
